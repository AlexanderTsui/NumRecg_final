# 手写数字识别项目文档

## 项目概述

本项目实现了一个基于鼠标绘制的手写数字识别系统，允许用户通过鼠标在屏幕上书写数字，系统会实时捕捉笔迹，并通过预训练的CNN神经网络模型识别用户书写的数字。

## 系统架构

系统由以下几个主要模块组成：

1. 鼠标笔迹捕捉模块
2. 图像处理模块 - 笔迹加粗、裁剪与预处理
3. 数字识别模块 - 基于`detect.py`的CNN神经网络模型

## 功能描述

### 1. 鼠标笔迹捕捉

- 用户按住鼠标左键开始书写，系统实时记录鼠标轨迹
- 松开鼠标左键后会有2秒的等待时间：
  - 若2秒内再次按下左键，继续记录并与先前笔迹合并
  - 若超过2秒未按下，则视为书写完成
  - 书写完成时，对笔迹加粗处理，并可视化显示用户最终书写的笔迹

### 2. 图像处理

- 智能裁剪：
  - 检测笔迹的水平和垂直范围
  - 取水平差值和垂直差值的较大值，乘以1.1作为边长
  - 生成正方形裁剪区域，确保用户笔迹完全在裁剪后的区域内
- 图像标准化：
  - 缩放至28×28像素，并进行二值化
  - 转换为黑底白字格式，符合模型输入要求

- 调试显示：
  - 在同一个窗口可视化显示裁剪后的图片、缩放后的图片、转换为黑底白字后的图片

### 3. 数字识别

- 使用预训练的CNN模型进行识别
- 输出识别结果

## 技术实现

### 依赖库

- pynput：用于鼠标事件监听
- PIL/Pillow：图像处理
- matplotlib：图像显示
- PyTorch：深度学习框架
- numpy：数据处理

### 核心算法

1. 笔迹合成算法：在用户短暂停顿后继续书写时，将新旧笔迹合并
2. 自适应裁剪算法：基于笔迹边界确定最佳裁剪区域
3. CNN卷积神经网络：用于数字识别的预训练模型

## 代码结构

```
project/
├── src/
│   ├── main.py           # 主程序（待实现）
│   ├── module/
│   │   ├── detect.py     # CNN识别模块
├── models/
│   └── model_Mnist.pth   # 预训练模型
```

## 后续改进方向

1. 添加用户界面，提升使用体验
2. 增加笔迹粗细调节功能
3. 支持多字符连续识别
4. 优化模型识别准确率
5. 添加错误修正与反馈机制